generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Pessoa {
  id                    Int                   @id @default(autoincrement())
  nome                  String                @unique
  cnpj                  String                @unique
  endereco              String?
  cep                   String?
  bairro                String?
  cidade                String?
  uf                    String?
  ativa                 Boolean               @default(true)
  created_at            DateTime              @default(now())
  updateda_at           DateTime              @updatedAt
  empresas_has_usuarios EmpresasHasUsuarios[]
  pessoas_has_tipos     PessoasHasTipos[]
  cargos_has_permissoes   CargosHasPermissoes[]

  @@map("pessoas")
}

model TiposPessoa {
  id                Int               @id @default(autoincrement())
  nome              String            @unique
  ativo             Boolean           @default(true)
  created_at        DateTime          @default(now())
  updateda_at       DateTime          @updatedAt
  pessoas_has_tipos PessoasHasTipos[]

  @@map("tipos_pessoas")
}

model Cargo {
  id                    Int                   @id @default(autoincrement())
  nome                  String                @unique
  ativo                 Boolean               @default(true)
  created_at            DateTime              @default(now())
  updateda_at           DateTime              @updatedAt
  empresas_has_usuarios EmpresasHasUsuarios[]
  cargos_has_permissoes CargosHasPermissoes[]

  @@map("cargos")
}

model PessoasHasTipos {
  id        Int         @id @default(autoincrement())
  pessoa_id Int
  tipo_id   Int
  pessoa    Pessoa      @relation(fields: [pessoa_id], references: [id])
  tipo      TiposPessoa @relation(fields: [tipo_id], references: [id])

  created_at  DateTime @default(now())
  updateda_at DateTime @updatedAt

  @@map("pessoas_has_tipo")
}

model User {
  id          Int      @id @default(autoincrement())
  email       String   @unique
  nome        String
  username    String   @unique
  password    String
  secret      String   @default(uuid())
  ativo       Boolean  @default(true)
  created_at  DateTime @default(now())
  updateda_at DateTime @updatedAt

  empresas_has_usuarios EmpresasHasUsuarios[]

  @@map("usuarios")
}

model EmpresasHasUsuarios {
  id          Int      @id @default(autoincrement())
  usuario_id  Int
  empresa_id  Int
  cargo_id    Int
  created_at  DateTime @default(now())
  updateda_at DateTime @updatedAt

  user   User   @relation(fields: [usuario_id], references: [id])
  pessoa Pessoa @relation(fields: [empresa_id], references: [id])
  cargo  Cargo  @relation(fields: [cargo_id], references: [id])

  @@map("empresas_has_usuarios")
}

model Permissoes {
  id                  Int                   @id @default(autoincrement())
  label               String
  key                 String
  message             String
  active              Boolean               @default(true)
  created_at          DateTime              @default(now())
  updateda_at         DateTime              @updatedAt
  cargos_has_ermissoes CargosHasPermissoes[]

  @@map("permissoes")
}

model CargosHasPermissoes {
  id           Int      @id @default(autoincrement())
  cargo_id     Int
  permissao_id Int
  empresa_id   Int
  createdAt    DateTime @default(now())
  updateda_at  DateTime @updatedAt

  cargo     Cargo      @relation(fields: [cargo_id], references: [id])
  empresa   Pessoa     @relation(fields: [empresa_id], references: [id])
  permissao Permissoes @relation(fields: [permissao_id], references: [id])

  @@map("cargos_has_permissoes")
}
